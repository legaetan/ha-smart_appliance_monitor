# Smart Appliance Monitor - Energy Dashboard
# Version: 2.0.0 - Complete Redesign
# Ultra-organized dashboard with 9 views for comprehensive energy monitoring

title: Energy (SAM)
icon: mdi:lightning-bolt
path: sam-energy

views:
  # ============================================
  # VUE 1: HOME - VUE D'ENSEMBLE
  # ============================================
  - title: Vue d'Ensemble
    path: home
    icon: mdi:home-lightning-bolt
    cards:
      # En-t√™te principal
      - type: markdown
        content: |
          # ‚ö° Smart Appliance Monitor
          **Dashboard √ânergie Complet** - Surveillance avanc√©e de 9 appareils

      # M√©triques totales
      - type: horizontal-stack
        cards:
          - type: custom:mushroom-template-card
            primary: Appareils Actifs
            secondary: |
              {% set active = namespace(count=0) %}
              {% set entities = [
                'sensor.lave_linge_state',
                'sensor.lave_vaisselle_state',
                'sensor.chauffe_eau_state',
                'sensor.four_state',
                'sensor.seche_linge_state',
                'sensor.bambulab_x1c_state',
                'sensor.ecran_pc_state',
                'sensor.bureau_pc_state',
                'sensor.vmc_state'
              ] %}
              {% for entity in entities %}
                {% if is_state(entity, 'running') %}
                  {% set active.count = active.count + 1 %}
                {% endif %}
              {% endfor %}
              {{ active.count }} en cours
            icon: mdi:devices
            icon_color: blue

          - type: custom:mushroom-template-card
            primary: Co√ªt Aujourd'hui
            secondary: |
              {% set total = (
                states('sensor.lave_linge_daily_cost') | float(0) +
                states('sensor.lave_vaisselle_daily_cost') | float(0) +
                states('sensor.chauffe_eau_daily_cost') | float(0) +
                states('sensor.four_daily_cost') | float(0) +
                states('sensor.seche_linge_daily_cost') | float(0) +
                states('sensor.bambulab_x1c_daily_cost') | float(0) +
                states('sensor.ecran_pc_daily_cost') | float(0) +
                states('sensor.bureau_pc_daily_cost') | float(0) +
                states('sensor.vmc_daily_cost') | float(0)
              ) | round(2) %}
              {{ total }} ‚Ç¨
            icon: mdi:currency-eur
            icon_color: green

          - type: custom:mushroom-template-card
            primary: Co√ªt Mensuel
            secondary: |
              {% set total = (
                states('sensor.lave_linge_monthly_cost') | float(0) +
                states('sensor.lave_vaisselle_monthly_cost') | float(0) +
                states('sensor.chauffe_eau_monthly_cost') | float(0) +
                states('sensor.four_monthly_cost') | float(0) +
                states('sensor.seche_linge_monthly_cost') | float(0) +
                states('sensor.bambulab_x1c_monthly_cost') | float(0) +
                states('sensor.ecran_pc_monthly_cost') | float(0) +
                states('sensor.bureau_pc_monthly_cost') | float(0) +
                states('sensor.vmc_monthly_cost') | float(0)
              ) | round(2) %}
              {{ total }} ‚Ç¨
            icon: mdi:calendar-month
            icon_color: amber

      # Bouton Sync Energy Dashboard
      - type: button
        name: Synchroniser Energy Dashboard
        icon: mdi:sync
        tap_action:
          action: call-service
          service: smart_appliance_monitor.sync_with_energy_dashboard

      # Grid des 9 appareils - Cartes compactes
      - type: vertical-stack
        cards:
          - type: markdown
            content: "## üìä Appareils Surveill√©s"
          
          # Ligne 1: Lave-Linge, Lave-Vaisselle, S√®che-Linge
          - type: horizontal-stack
            cards:
              - type: custom:mushroom-template-card
                primary: Lave-Linge
                secondary: |
                  {% set state = states('sensor.lave_linge_state') %}
                  {% if state == 'running' %}
                    üîµ {{ states('sensor.lave_linge_cycle_duration') }} min
                  {% elif state == 'finished' %}
                    ‚úÖ Termin√©
                  {% else %}
                    ‚ö™ Pr√™t
                  {% endif %}
                icon: mdi:washing-machine
                icon_color: |
                  {% if is_state('sensor.lave_linge_state', 'running') %}
                    blue
                  {% elif is_state('sensor.lave_linge_state', 'finished') %}
                    green
                  {% else %}
                    grey
                  {% endif %}
                tap_action:
                  action: navigate
                  navigation_path: /lovelace/lave_linge

              - type: custom:mushroom-template-card
                primary: Lave-Vaisselle
                secondary: |
                  {% set state = states('sensor.lave_vaisselle_state') %}
                  {% if state == 'running' %}
                    üîµ {{ states('sensor.lave_vaisselle_cycle_duration') }} min
                  {% elif state == 'finished' %}
                    ‚úÖ Termin√©
                  {% else %}
                    ‚ö™ Pr√™t
                  {% endif %}
                icon: mdi:dishwasher
                icon_color: |
                  {% if is_state('sensor.lave_vaisselle_state', 'running') %}
                    blue
                  {% elif is_state('sensor.lave_vaisselle_state', 'finished') %}
                    green
                  {% else %}
                    grey
                  {% endif %}
                tap_action:
                  action: navigate
                  navigation_path: /lovelace/lave_vaisselle

              - type: custom:mushroom-template-card
                primary: S√®che-Linge
                secondary: |
                  {% set state = states('sensor.seche_linge_state') %}
                  {% if state == 'running' %}
                    üîµ {{ states('sensor.seche_linge_cycle_duration') }} min
                  {% elif state == 'finished' %}
                    ‚úÖ Termin√©
                  {% else %}
                    ‚ö™ Pr√™t
                  {% endif %}
                icon: mdi:tumble-dryer
                icon_color: |
                  {% if is_state('sensor.seche_linge_state', 'running') %}
                    blue
                  {% elif is_state('sensor.seche_linge_state', 'finished') %}
                    green
                  {% else %}
                    grey
                  {% endif %}
                tap_action:
                  action: navigate
                  navigation_path: /lovelace/seche_linge

          # Ligne 2: Chauffe-Eau, Four, Imprimante 3D
          - type: horizontal-stack
            cards:
              - type: custom:mushroom-template-card
                primary: Chauffe-Eau
                secondary: |
                  {% if is_state('sensor.chauffe_eau_state', 'running') %}
                    üîµ Chauffe
                  {% else %}
                    ‚ö™ Inactif
                  {% endif %}
                icon: mdi:water-boiler
                icon_color: |
                  {% if is_state('sensor.chauffe_eau_state', 'running') %}
                    blue
                  {% else %}
                    grey
                  {% endif %}
                tap_action:
                  action: navigate
                  navigation_path: /lovelace/chauffe_eau

              - type: custom:mushroom-template-card
                primary: Four
                secondary: |
                  {% if is_state('sensor.four_state', 'running') %}
                    üîµ Cuisson
                  {% else %}
                    ‚ö™ √âteint
                  {% endif %}
                icon: mdi:stove
                icon_color: |
                  {% if is_state('sensor.four_state', 'running') %}
                    blue
                  {% else %}
                    grey
                  {% endif %}
                tap_action:
                  action: navigate
                  navigation_path: /lovelace/four

              - type: custom:mushroom-template-card
                primary: Bambulab X1C
                secondary: |
                  {% if is_state('sensor.bambulab_x1c_state', 'running') %}
                    üîµ Impression
                  {% else %}
                    ‚ö™ Pr√™t
                  {% endif %}
                icon: mdi:printer-3d
                icon_color: |
                  {% if is_state('sensor.bambulab_x1c_state', 'running') %}
                    blue
                  {% else %}
                    grey
                  {% endif %}
                tap_action:
                  action: navigate
                  navigation_path: /lovelace/bambulab_x1c

          # Ligne 3: √âcran PC, PC Bureau, VMC
          - type: horizontal-stack
            cards:
              - type: custom:mushroom-template-card
                primary: √âcran PC
                secondary: |
                  {% if is_state('sensor.ecran_pc_state', 'running') %}
                    üîµ Allum√©
                  {% else %}
                    ‚ö™ √âteint
                  {% endif %}
                icon: mdi:monitor
                icon_color: |
                  {% if is_state('sensor.ecran_pc_state', 'running') %}
                    blue
                  {% else %}
                    grey
                  {% endif %}
                tap_action:
                  action: navigate
                  navigation_path: /lovelace/ecran_pc

              - type: custom:mushroom-template-card
                primary: PC Bureau
                secondary: |
                  {% if is_state('sensor.bureau_pc_state', 'running') %}
                    üîµ Allum√©
                  {% else %}
                    ‚ö™ √âteint
                  {% endif %}
                icon: mdi:desktop-tower
                icon_color: |
                  {% if is_state('sensor.bureau_pc_state', 'running') %}
                    blue
                  {% else %}
                    grey
                  {% endif %}
                tap_action:
                  action: navigate
                  navigation_path: /lovelace/bureau_pc

              - type: custom:mushroom-template-card
                primary: VMC
                secondary: |
                  {% if is_state('sensor.vmc_state', 'running') %}
                    üîµ Boost
                  {% else %}
                    ‚ö™ Normal
                  {% endif %}
                icon: mdi:fan
                icon_color: |
                  {% if is_state('sensor.vmc_state', 'running') %}
                    blue
                  {% else %}
                    grey
                  {% endif %}
                tap_action:
                  action: navigate
                  navigation_path: /lovelace/vmc

      # Top Consommateurs du Jour
      - type: vertical-stack
        cards:
          - type: markdown
            content: "## üèÜ Top Consommateurs (Aujourd'hui)"
          
          - type: entities
            entities:
              - entity: sensor.chauffe_eau_daily_energy
                name: Chauffe-Eau
                icon: mdi:water-boiler
              - entity: sensor.lave_linge_daily_energy
                name: Lave-Linge
                icon: mdi:washing-machine
              - entity: sensor.four_daily_energy
                name: Four
                icon: mdi:stove
              - entity: sensor.lave_vaisselle_daily_energy
                name: Lave-Vaisselle
                icon: mdi:dishwasher
              - entity: sensor.seche_linge_daily_energy
                name: S√®che-Linge
                icon: mdi:tumble-dryer
              - entity: sensor.bambulab_x1c_daily_energy
                name: Imprimante 3D
                icon: mdi:printer-3d
              - entity: sensor.ecran_pc_daily_energy
                name: √âcran PC
                icon: mdi:monitor
              - entity: sensor.bureau_pc_daily_energy
                name: PC Bureau
                icon: mdi:desktop-tower
              - entity: sensor.vmc_daily_energy
                name: VMC
                icon: mdi:fan
            state_color: true

      # Alertes Actives
      - type: vertical-stack
        cards:
          - type: markdown
            content: "## ‚ö†Ô∏è Alertes Actives"
          
          - type: custom:auto-entities
            card:
              type: entities
              title: Alertes de Dur√©e
              state_color: true
            filter:
              include:
                - entity_id: binary_sensor.*_alert_duration
                  state: "on"
              exclude: []

          - type: custom:auto-entities
            card:
              type: entities
              title: Appareils D√©branch√©s
              state_color: true
            filter:
              include:
                - entity_id: binary_sensor.*_unplugged
                  state: "on"
              exclude: []

          - type: custom:auto-entities
            card:
              type: entities
              title: Anomalies D√©tect√©es
              state_color: true
            filter:
              include:
                - entity_id: binary_sensor.*_anomaly_detected
                  state: "on"
              exclude: []

  # ============================================
  # VUE 2: MONITORING - √âTAT DES APPAREILS
  # ============================================
  - title: Monitoring
    path: monitoring
    icon: mdi:monitor-dashboard
    cards:
      - type: markdown
        content: |
          ## üì∫ Monitoring en Temps R√©el

      # √âtat de tous les appareils
      - type: entities
        title: √âtat des Appareils
        state_color: true
        entities:
          - entity: sensor.lave_linge_state
            name: "üß∫ Lave-Linge"
          - entity: sensor.lave_vaisselle_state
            name: "üçΩÔ∏è Lave-Vaisselle"
          - entity: sensor.seche_linge_state
            name: "üëï S√®che-Linge"
          - entity: sensor.chauffe_eau_state
            name: "üíß Chauffe-Eau"
          - entity: sensor.four_state
            name: "üçï Four"
          - entity: sensor.bambulab_x1c_state
            name: "üñ®Ô∏è Imprimante 3D"
          - entity: sensor.ecran_pc_state
            name: "üñ•Ô∏è √âcran PC"
          - entity: sensor.bureau_pc_state
            name: "üíª PC Bureau"
          - entity: sensor.vmc_state
            name: "üí® VMC"

      # Cycles/Sessions en Cours
      - type: custom:auto-entities
        card:
          type: entities
          title: Cycles/Sessions Actifs
        filter:
          include:
            - entity_id: sensor.lave_linge_cycle_duration
              state: ">0"
              name: "üß∫ Lave-Linge"
            - entity_id: sensor.lave_vaisselle_cycle_duration
              state: ">0"
              name: "üçΩÔ∏è Lave-Vaisselle"
            - entity_id: sensor.seche_linge_cycle_duration
              state: ">0"
              name: "üëï S√®che-Linge"
            - entity_id: sensor.chauffe_eau_cycle_duration
              state: ">0"
              name: "üíß Chauffe-Eau"
            - entity_id: sensor.four_cycle_duration
              state: ">0"
              name: "üçï Four"
            - entity_id: sensor.bambulab_x1c_cycle_duration
              state: ">0"
              name: "üñ®Ô∏è Imprimante 3D"
          exclude:
            - state: "0"
            - state: "unavailable"

      # Graphique Multi-courbes des Puissances
      - type: custom:apexcharts-card
        header:
          show: true
          title: üìä Puissances en Temps R√©el (24h)
          show_states: true
        graph_span: 24h
        all_series_config:
          type: line
          stroke_width: 2
          curve: smooth
        series:
          - entity: sensor.lave_linge_power
            name: Lave-Linge
            color: '#3498db'
          - entity: sensor.lave_vaisselle_power
            name: Lave-Vaisselle
            color: '#16a085'
          - entity: sensor.seche_linge_power
            name: S√®che-Linge
            color: '#e67e22'
          - entity: sensor.chauffe_eau_power
            name: Chauffe-Eau
            color: '#f39c12'
          - entity: sensor.four_power
            name: Four
            color: '#9b59b6'
          - entity: sensor.bambulab_x1c_power
            name: Imprimante 3D
            color: '#e74c3c'

  # ============================================
  # VUE 3: D√âTAILS APPAREILS
  # ============================================
  - title: D√©tails Appareils
    path: details
    icon: mdi:information-variant
    cards:
      - type: markdown
        content: |
          ## üìã D√©tails par Appareil
          Surveillance d√©taill√©e avec cartes custom

      # ========== LAVE-LINGE ==========
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### üß∫ Lave-Linge"
          
          - type: custom:smart-appliance-cycle-card
            entity: sensor.lave_linge_state
            name: "Lave-Linge"
            icon: "mdi:washing-machine"
            show_power_graph: true
            show_action_buttons: true
            show_current_power: true
            graph_hours: 0.5
            theme: auto

          - type: custom:smart-appliance-stats-card
            entity: sensor.lave_linge_state
            name: "Statistiques Lave-Linge"
            default_tab: today
            show_trends: true
            show_efficiency: true
            theme: auto

      # ========== LAVE-VAISSELLE ==========
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### üçΩÔ∏è Lave-Vaisselle"
          
          - type: custom:smart-appliance-cycle-card
            entity: sensor.lave_vaisselle_state
            name: "Lave-Vaisselle"
            icon: "mdi:dishwasher"
            show_power_graph: true
            show_action_buttons: true
            show_current_power: true
            graph_hours: 0.5
            theme: auto

          - type: custom:smart-appliance-stats-card
            entity: sensor.lave_vaisselle_state
            name: "Statistiques Lave-Vaisselle"
            default_tab: today
            show_trends: true
            show_efficiency: true
            theme: auto

      # ========== S√àCHE-LINGE ==========
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### üëï S√®che-Linge"
          
          - type: custom:smart-appliance-cycle-card
            entity: sensor.seche_linge_state
            name: "S√®che-Linge"
            icon: "mdi:tumble-dryer"
            show_power_graph: true
            show_action_buttons: true
            show_current_power: true
            graph_hours: 0.5
            theme: auto

          - type: custom:smart-appliance-stats-card
            entity: sensor.seche_linge_state
            name: "Statistiques S√®che-Linge"
            default_tab: today
            show_trends: true
            show_efficiency: true
            theme: auto

      # ========== CHAUFFE-EAU ==========
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### üíß Chauffe-Eau"
          
          - type: custom:smart-appliance-cycle-card
            entity: sensor.chauffe_eau_state
            name: "Chauffe-Eau"
            icon: "mdi:water-boiler"
            show_power_graph: true
            show_action_buttons: true
            show_current_power: true
            graph_hours: 1
            theme: auto

          - type: custom:smart-appliance-stats-card
            entity: sensor.chauffe_eau_state
            name: "Statistiques Chauffe-Eau"
            default_tab: today
            show_trends: true
            show_efficiency: true
            theme: auto

      # ========== FOUR ==========
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### üçï Four"
          
          - type: custom:smart-appliance-cycle-card
            entity: sensor.four_state
            name: "Four"
            icon: "mdi:stove"
            show_power_graph: true
            show_action_buttons: true
            show_current_power: true
            graph_hours: 0.5
            theme: auto

          - type: custom:smart-appliance-stats-card
            entity: sensor.four_state
            name: "Statistiques Four"
            default_tab: today
            show_trends: true
            show_efficiency: true
            theme: auto

      # ========== IMPRIMANTE 3D ==========
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### üñ®Ô∏è Imprimante 3D (Bambulab X1C)"
          
          - type: custom:smart-appliance-cycle-card
            entity: sensor.bambulab_x1c_state
            name: "Bambulab X1C"
            icon: "mdi:printer-3d"
            show_power_graph: true
            show_action_buttons: true
            show_current_power: true
            graph_hours: 2
            theme: auto

          - type: custom:smart-appliance-stats-card
            entity: sensor.bambulab_x1c_state
            name: "Statistiques Imprimante 3D"
            default_tab: today
            show_trends: true
            show_efficiency: true
            theme: auto

      # ========== √âCRAN PC ==========
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### üñ•Ô∏è √âcran PC"
          
          - type: custom:smart-appliance-cycle-card
            entity: sensor.ecran_pc_state
            name: "√âcran PC"
            icon: "mdi:monitor"
            show_power_graph: true
            show_action_buttons: true
            show_current_power: true
            graph_hours: 1
            theme: auto

          - type: custom:smart-appliance-stats-card
            entity: sensor.ecran_pc_state
            name: "Statistiques √âcran PC"
            default_tab: today
            show_trends: true
            show_efficiency: true
            theme: auto

      # ========== PC BUREAU ==========
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### üíª PC Bureau"
          
          - type: custom:smart-appliance-cycle-card
            entity: sensor.bureau_pc_state
            name: "PC Bureau"
            icon: "mdi:desktop-tower"
            show_power_graph: true
            show_action_buttons: true
            show_current_power: true
            graph_hours: 1
            theme: auto

          - type: custom:smart-appliance-stats-card
            entity: sensor.bureau_pc_state
            name: "Statistiques PC Bureau"
            default_tab: today
            show_trends: true
            show_efficiency: true
            theme: auto

      # ========== VMC ==========
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### üí® VMC"
          
          - type: custom:smart-appliance-cycle-card
            entity: sensor.vmc_state
            name: "VMC"
            icon: "mdi:fan"
            show_power_graph: true
            show_action_buttons: true
            show_current_power: true
            graph_hours: 0.5
            theme: auto

          - type: custom:smart-appliance-stats-card
            entity: sensor.vmc_state
            name: "Statistiques VMC"
            default_tab: today
            show_trends: true
            show_efficiency: true
            theme: auto

  # ============================================
  # VUE 4: √âNERGIE & CO√õTS
  # ============================================
  - title: √ânergie & Co√ªts
    path: energy
    icon: mdi:currency-eur
    cards:
      - type: markdown
        content: |
          ## üí∞ √ânergie & Co√ªts
          Analyse d√©taill√©e de la consommation et des d√©penses

      # Bouton Sync Energy Dashboard
      - type: button
        name: Synchroniser Energy Dashboard
        icon: mdi:sync
        tap_action:
          action: call-service
          service: smart_appliance_monitor.sync_with_energy_dashboard

      # Consommation par Appareil - Graphiques Comparatifs
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### üìä Consommation par Appareil"
          
          - type: custom:apexcharts-card
            header:
              show: true
              title: Consommation Journali√®re (7 derniers jours)
              show_states: true
            graph_span: 7d
            span:
              end: day
            all_series_config:
              type: column
              stroke_width: 0
              group_by:
                func: sum
                duration: 1d
            series:
              - entity: sensor.lave_linge_daily_energy
                name: Lave-Linge
                color: '#3498db'
              - entity: sensor.lave_vaisselle_daily_energy
                name: Lave-Vaisselle
                color: '#16a085'
              - entity: sensor.seche_linge_daily_energy
                name: S√®che-Linge
                color: '#e67e22'
              - entity: sensor.chauffe_eau_daily_energy
                name: Chauffe-Eau
                color: '#f39c12'
              - entity: sensor.four_daily_energy
                name: Four
                color: '#9b59b6'
              - entity: sensor.bambulab_x1c_daily_energy
                name: Imprimante 3D
                color: '#e74c3c'
              - entity: sensor.ecran_pc_daily_energy
                name: √âcran PC
                color: '#95a5a6'
              - entity: sensor.bureau_pc_daily_energy
                name: PC Bureau
                color: '#34495e'
              - entity: sensor.vmc_daily_energy
                name: VMC
                color: '#1abc9c'

      # Co√ªts Quotidiens - 7 jours
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### üí∏ Co√ªts Quotidiens (7 jours)"
          
          - type: custom:apexcharts-card
            header:
              show: true
              title: Co√ªts par Appareil (7j)
              show_states: true
            graph_span: 7d
            span:
              end: day
            all_series_config:
              type: line
              stroke_width: 2
              curve: smooth
              group_by:
                func: sum
                duration: 1d
            series:
              - entity: sensor.lave_linge_daily_cost
                name: Lave-Linge
                color: '#3498db'
              - entity: sensor.lave_vaisselle_daily_cost
                name: Lave-Vaisselle
                color: '#16a085'
              - entity: sensor.seche_linge_daily_cost
                name: S√®che-Linge
                color: '#e67e22'
              - entity: sensor.chauffe_eau_daily_cost
                name: Chauffe-Eau
                color: '#f39c12'
              - entity: sensor.four_daily_cost
                name: Four
                color: '#9b59b6'
              - entity: sensor.bambulab_x1c_daily_cost
                name: Imprimante 3D
                color: '#e74c3c'

      # Co√ªts Mensuels - 12 mois
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### üìÖ Co√ªts Mensuels (12 mois)"
          
          - type: custom:apexcharts-card
            header:
              show: true
              title: √âvolution Mensuelle des Co√ªts
              show_states: true
            graph_span: 12month
            span:
              end: month
            all_series_config:
              type: column
              stroke_width: 0
              group_by:
                func: sum
                duration: 1month
            series:
              - entity: sensor.lave_linge_monthly_cost
                name: Lave-Linge
                color: '#3498db'
              - entity: sensor.lave_vaisselle_monthly_cost
                name: Lave-Vaisselle
                color: '#16a085'
              - entity: sensor.seche_linge_monthly_cost
                name: S√®che-Linge
                color: '#e67e22'
              - entity: sensor.chauffe_eau_monthly_cost
                name: Chauffe-Eau
                color: '#f39c12'
              - entity: sensor.four_monthly_cost
                name: Four
                color: '#9b59b6'
              - entity: sensor.bambulab_x1c_monthly_cost
                name: Imprimante 3D
                color: '#e74c3c'

      # Projections de Co√ªt Mensuel
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### üîÆ Projections Mensuelles"
          
          - type: horizontal-stack
            cards:
              - type: custom:mushroom-template-card
                primary: Total Actuel
                secondary: |
                  {% set total = (
                    states('sensor.lave_linge_monthly_cost') | float(0) +
                    states('sensor.lave_vaisselle_monthly_cost') | float(0) +
                    states('sensor.chauffe_eau_monthly_cost') | float(0) +
                    states('sensor.four_monthly_cost') | float(0) +
                    states('sensor.seche_linge_monthly_cost') | float(0) +
                    states('sensor.bambulab_x1c_monthly_cost') | float(0) +
                    states('sensor.ecran_pc_monthly_cost') | float(0) +
                    states('sensor.bureau_pc_monthly_cost') | float(0) +
                    states('sensor.vmc_monthly_cost') | float(0)
                  ) | round(2) %}
                  {{ total }} ‚Ç¨
                icon: mdi:currency-eur
                icon_color: green

              - type: custom:mushroom-template-card
                primary: Projection Fin Mois
                secondary: |
                  {% set now = now() %}
                  {% set day_of_month = now.day %}
                  {% set days_in_month = (now.replace(day=1) + timedelta(days=32)).replace(day=1).replace(day=1) - timedelta(days=1) %}
                  {% set days_in_month_num = days_in_month.day %}
                  {% set total_current = (
                    states('sensor.lave_linge_monthly_cost') | float(0) +
                    states('sensor.lave_vaisselle_monthly_cost') | float(0) +
                    states('sensor.chauffe_eau_monthly_cost') | float(0) +
                    states('sensor.four_monthly_cost') | float(0) +
                    states('sensor.seche_linge_monthly_cost') | float(0) +
                    states('sensor.bambulab_x1c_monthly_cost') | float(0) +
                    states('sensor.ecran_pc_monthly_cost') | float(0) +
                    states('sensor.bureau_pc_monthly_cost') | float(0) +
                    states('sensor.vmc_monthly_cost') | float(0)
                  ) %}
                  {% set projection = (total_current / day_of_month * days_in_month_num) | round(2) %}
                  {{ projection }} ‚Ç¨
                icon: mdi:crystal-ball
                icon_color: purple

      # Classement Consommateurs
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### üèÜ Classement des Consommateurs (Ce Mois)"
          
          - type: custom:bar-card
            entities:
              - entity: sensor.chauffe_eau_monthly_cost
                name: Chauffe-Eau
                icon: mdi:water-boiler
              - entity: sensor.lave_linge_monthly_cost
                name: Lave-Linge
                icon: mdi:washing-machine
              - entity: sensor.four_monthly_cost
                name: Four
                icon: mdi:stove
              - entity: sensor.lave_vaisselle_monthly_cost
                name: Lave-Vaisselle
                icon: mdi:dishwasher
              - entity: sensor.seche_linge_monthly_cost
                name: S√®che-Linge
                icon: mdi:tumble-dryer
              - entity: sensor.bambulab_x1c_monthly_cost
                name: Imprimante 3D
                icon: mdi:printer-3d
              - entity: sensor.ecran_pc_monthly_cost
                name: √âcran PC
                icon: mdi:monitor
              - entity: sensor.bureau_pc_monthly_cost
                name: PC Bureau
                icon: mdi:desktop-tower
              - entity: sensor.vmc_monthly_cost
                name: VMC
                icon: mdi:fan
            unit_of_measurement: ‚Ç¨
            severity:
              - value: 0
                color: '#2ecc71'
              - value: 10
                color: '#f39c12'
              - value: 30
                color: '#e74c3c'
            positions:
              icon: outside
              name: inside
              value: inside

      # Budget Tracking
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### üí≥ Suivi de Budget"
          
          - type: horizontal-stack
            cards:
              - type: gauge
                entity: sensor.lave_linge_monthly_cost
                name: Lave-Linge
                min: 0
                max: 20
                unit: ‚Ç¨
                needle: true
                severity:
                  green: 0
                  yellow: 12
                  red: 16

              - type: gauge
                entity: sensor.lave_vaisselle_monthly_cost
                name: Lave-Vaisselle
                min: 0
                max: 20
                unit: ‚Ç¨
                needle: true
                severity:
                  green: 0
                  yellow: 12
                  red: 16

              - type: gauge
                entity: sensor.seche_linge_monthly_cost
                name: S√®che-Linge
                min: 0
                max: 30
                unit: ‚Ç¨
                needle: true
                severity:
                  green: 0
                  yellow: 18
                  red: 24

          - type: horizontal-stack
            cards:
              - type: gauge
                entity: sensor.chauffe_eau_monthly_cost
                name: Chauffe-Eau
                min: 0
                max: 50
                unit: ‚Ç¨
                needle: true
                severity:
                  green: 0
                  yellow: 30
                  red: 40

              - type: gauge
                entity: sensor.four_monthly_cost
                name: Four
                min: 0
                max: 15
                unit: ‚Ç¨
                needle: true
                severity:
                  green: 0
                  yellow: 9
                  red: 12

              - type: gauge
                entity: sensor.bambulab_x1c_monthly_cost
                name: Imprimante 3D
                min: 0
                max: 30
                unit: ‚Ç¨
                needle: true
                severity:
                  green: 0
                  yellow: 18
                  red: 24

  # ============================================
  # VUE 5: ANALYSE IA
  # ============================================
  - title: Analyse IA
    path: ai
    icon: mdi:robot
    cards:
      - type: markdown
        content: |
          ## ü§ñ Analyse IA
          Analyse intelligente des cycles et recommandations d'√©conomie

      # Configuration Globale
      - type: entities
        title: Configuration Globale IA
        entities:
          - entity: select.smart_appliance_monitor_ai_task
            name: T√¢che IA
          - entity: select.smart_appliance_monitor_price_entity
            name: Entit√© Prix

      # Switches Activation IA par Appareil
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### ‚öôÔ∏è Activation IA par Appareil"
          
          - type: entities
            title: Analyse IA Automatique
            entities:
              - entity: switch.lave_linge_ai_analysis
                name: "üß∫ Lave-Linge"
              - entity: switch.lave_vaisselle_ai_analysis
                name: "üçΩÔ∏è Lave-Vaisselle"
              - entity: switch.seche_linge_ai_analysis
                name: "üëï S√®che-Linge"
              - entity: switch.chauffe_eau_ai_analysis
                name: "üíß Chauffe-Eau"
              - entity: switch.four_ai_analysis
                name: "üçï Four"
              - entity: switch.bambulab_x1c_ai_analysis
                name: "üñ®Ô∏è Imprimante 3D"
              - entity: switch.ecran_pc_ai_analysis
                name: "üñ•Ô∏è √âcran PC"
              - entity: switch.bureau_pc_ai_analysis
                name: "üíª PC Bureau"
              - entity: switch.vmc_ai_analysis
                name: "üí® VMC"

      # Boutons Analyse par Appareil
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### üîç Analyses Manuelles"
          
          # Lave-Linge
          - type: horizontal-stack
            cards:
              - type: custom:mushroom-template-card
                primary: "üß∫ Lave-Linge"
                icon: mdi:washing-machine
                icon_color: blue
                tap_action:
                  action: none
              - type: button
                name: Pattern
                icon: mdi:chart-timeline-variant
                tap_action:
                  action: call-service
                  service: smart_appliance_monitor.analyze_cycles
                  service_data:
                    entity_id: sensor.lave_linge_state
                    analysis_type: pattern
                    cycle_count: 10
              - type: button
                name: Recommandations
                icon: mdi:lightbulb-on
                tap_action:
                  action: call-service
                  service: smart_appliance_monitor.analyze_cycles
                  service_data:
                    entity_id: sensor.lave_linge_state
                    analysis_type: recommendations
                    cycle_count: 10
              - type: button
                name: Compl√®te
                icon: mdi:chart-box
                tap_action:
                  action: call-service
                  service: smart_appliance_monitor.analyze_cycles
                  service_data:
                    entity_id: sensor.lave_linge_state
                    analysis_type: all
                    cycle_count: 10

          # Lave-Vaisselle
          - type: horizontal-stack
            cards:
              - type: custom:mushroom-template-card
                primary: "üçΩÔ∏è Lave-Vaisselle"
                icon: mdi:dishwasher
                icon_color: teal
                tap_action:
                  action: none
              - type: button
                name: Pattern
                icon: mdi:chart-timeline-variant
                tap_action:
                  action: call-service
                  service: smart_appliance_monitor.analyze_cycles
                  service_data:
                    entity_id: sensor.lave_vaisselle_state
                    analysis_type: pattern
                    cycle_count: 10
              - type: button
                name: Recommandations
                icon: mdi:lightbulb-on
                tap_action:
                  action: call-service
                  service: smart_appliance_monitor.analyze_cycles
                  service_data:
                    entity_id: sensor.lave_vaisselle_state
                    analysis_type: recommendations
                    cycle_count: 10
              - type: button
                name: Compl√®te
                icon: mdi:chart-box
                tap_action:
                  action: call-service
                  service: smart_appliance_monitor.analyze_cycles
                  service_data:
                    entity_id: sensor.lave_vaisselle_state
                    analysis_type: all
                    cycle_count: 10

      # R√©sultats d'Analyse avec Markdown
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### üìä R√©sultats d'Analyse"
          
          - type: markdown
            content: >
              #### üß∫ Lave-Linge

              **R√©sum√©:** {{ state_attr('sensor.lave_linge_ai_analysis', 'summary') | default('Aucune analyse disponible', true) }}
              
              **Recommandations:** {{ state_attr('sensor.lave_linge_ai_analysis', 'recommendations') | default('N/A', true) }}

          - type: markdown
            content: >
              #### üçΩÔ∏è Lave-Vaisselle

              **R√©sum√©:** {{ state_attr('sensor.lave_vaisselle_ai_analysis', 'summary') | default('Aucune analyse disponible', true) }}
              
              **Recommandations:** {{ state_attr('sensor.lave_vaisselle_ai_analysis', 'recommendations') | default('N/A', true) }}

      # √âconomies Potentielles
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### üí° √âconomies Potentielles"
          
          - type: horizontal-stack
            cards:
              - type: custom:mushroom-template-card
                primary: Lave-Linge
                secondary: "{{ state_attr('sensor.lave_linge_ai_analysis', 'energy_savings_kwh') | default('N/A', true) }} kWh | {{ state_attr('sensor.lave_linge_ai_analysis', 'energy_savings_eur') | default('N/A', true) }} ‚Ç¨"
                icon: mdi:washing-machine
                icon_color: green
              
              - type: custom:mushroom-template-card
                primary: Lave-Vaisselle
                secondary: "{{ state_attr('sensor.lave_vaisselle_ai_analysis', 'energy_savings_kwh') | default('N/A', true) }} kWh | {{ state_attr('sensor.lave_vaisselle_ai_analysis', 'energy_savings_eur') | default('N/A', true) }} ‚Ç¨"
                icon: mdi:dishwasher
                icon_color: green

  # ============================================
  # VUE 6: ALERTES & ANOMALIES
  # ============================================
  - title: Alertes & Anomalies
    path: alerts
    icon: mdi:alert-decagram
    cards:
      - type: markdown
        content: |
          ## ‚ö†Ô∏è Alertes & Anomalies
          Surveillance des alertes et d√©tection d'anomalies

      # Alertes Actives
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### üö® Alertes Actives"
          
          - type: custom:auto-entities
            card:
              type: entities
              title: Alertes Dur√©e
              state_color: true
            filter:
              include:
                - entity_id: binary_sensor.*_alert_duration
                  state: "on"
              exclude: []
          
          - type: custom:auto-entities
            card:
              type: entities
              title: Appareils D√©branch√©s
              state_color: true
            filter:
              include:
                - entity_id: binary_sensor.*_unplugged
                  state: "on"
              exclude: []
          
          - type: custom:auto-entities
            card:
              type: entities
              title: D√©passements Limites √ânergie
              state_color: true
            filter:
              include:
                - entity_id: binary_sensor.*_energy_limit_exceeded
                  state: "on"
              exclude: []
          
          - type: custom:auto-entities
            card:
              type: entities
              title: D√©passements Budget
              state_color: true
            filter:
              include:
                - entity_id: binary_sensor.*_budget_exceeded
                  state: "on"
              exclude: []

      # Anomalies D√©tect√©es
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### üîç D√©tection d'Anomalies"
          
          - type: custom:auto-entities
            card:
              type: entities
              title: Anomalies Actives
              state_color: true
            filter:
              include:
                - entity_id: binary_sensor.*_anomaly_detected
                  state: "on"
              exclude: []

      # Gauges Scores d'Anomalies
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### üìä Scores d'Anomalies"
          
          - type: horizontal-stack
            cards:
              - type: gauge
                entity: sensor.lave_linge_anomaly_score
                name: Lave-Linge
                min: 0
                max: 100
                needle: true
                severity:
                  green: 0
                  yellow: 30
                  red: 60
              
              - type: gauge
                entity: sensor.lave_vaisselle_anomaly_score
                name: Lave-Vaisselle
                min: 0
                max: 100
                needle: true
                severity:
                  green: 0
                  yellow: 30
                  red: 60
              
              - type: gauge
                entity: sensor.seche_linge_anomaly_score
                name: S√®che-Linge
                min: 0
                max: 100
                needle: true
                severity:
                  green: 0
                  yellow: 30
                  red: 60

          - type: horizontal-stack
            cards:
              - type: gauge
                entity: sensor.chauffe_eau_anomaly_score
                name: Chauffe-Eau
                min: 0
                max: 100
                needle: true
                severity:
                  green: 0
                  yellow: 30
                  red: 60
              
              - type: gauge
                entity: sensor.four_anomaly_score
                name: Four
                min: 0
                max: 100
                needle: true
                severity:
                  green: 0
                  yellow: 30
                  red: 60
              
              - type: gauge
                entity: sensor.bambulab_x1c_anomaly_score
                name: Imprimante 3D
                min: 0
                max: 100
                needle: true
                severity:
                  green: 0
                  yellow: 30
                  red: 60

      # Historique Scores (7j)
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### üìà Historique des Scores (7 jours)"
          
          - type: custom:apexcharts-card
            header:
              show: true
              title: √âvolution Scores d'Anomalies
              show_states: true
            graph_span: 7d
            all_series_config:
              type: line
              stroke_width: 2
              curve: smooth
            series:
              - entity: sensor.lave_linge_anomaly_score
                name: Lave-Linge
                color: '#3498db'
              - entity: sensor.lave_vaisselle_anomaly_score
                name: Lave-Vaisselle
                color: '#16a085'
              - entity: sensor.seche_linge_anomaly_score
                name: S√®che-Linge
                color: '#e67e22'
              - entity: sensor.chauffe_eau_anomaly_score
                name: Chauffe-Eau
                color: '#f39c12'
              - entity: sensor.four_anomaly_score
                name: Four
                color: '#9b59b6'
              - entity: sensor.bambulab_x1c_anomaly_score
                name: Imprimante 3D
                color: '#e74c3c'

      # Usage Allowed (Scheduling)
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### ‚è∞ Planification - Usage Autoris√©"
          
          - type: entities
            title: √âtat Planification
            entities:
              - entity: binary_sensor.lave_linge_usage_allowed
                name: "üß∫ Lave-Linge"
              - entity: binary_sensor.lave_vaisselle_usage_allowed
                name: "üçΩÔ∏è Lave-Vaisselle"
              - entity: binary_sensor.seche_linge_usage_allowed
                name: "üëï S√®che-Linge"
              - entity: binary_sensor.chauffe_eau_usage_allowed
                name: "üíß Chauffe-Eau"
              - entity: binary_sensor.four_usage_allowed
                name: "üçï Four"

  # ============================================
  # VUE 7: GESTION √âNERG√âTIQUE
  # ============================================
  - title: Gestion √ânergie
    path: energy-management
    icon: mdi:cog
    cards:
      - type: markdown
        content: |
          ## ‚öôÔ∏è Gestion √ânerg√©tique
          Configuration des limites, budgets et planifications

      # Energy Management Switches
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### üéõÔ∏è Limites √ânerg√©tiques"
          
          - type: entities
            title: Activation Limites par Appareil
            entities:
              - entity: switch.lave_linge_energy_limits
                name: "üß∫ Lave-Linge"
              - entity: switch.lave_vaisselle_energy_limits
                name: "üçΩÔ∏è Lave-Vaisselle"
              - entity: switch.seche_linge_energy_limits
                name: "üëï S√®che-Linge"
              - entity: switch.chauffe_eau_energy_limits
                name: "üíß Chauffe-Eau"
              - entity: switch.four_energy_limits
                name: "üçï Four"
              - entity: switch.bambulab_x1c_energy_limits
                name: "üñ®Ô∏è Imprimante 3D"

      # Gauges Consommation vs Limites
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### üìä Consommation vs Limites (Jour)"
          
          - type: horizontal-stack
            cards:
              - type: gauge
                entity: sensor.lave_linge_daily_energy
                name: Lave-Linge
                min: 0
                max: 3
                unit: kWh
                needle: true
                severity:
                  green: 0
                  yellow: 1.8
                  red: 2.4
              
              - type: gauge
                entity: sensor.lave_vaisselle_daily_energy
                name: Lave-Vaisselle
                min: 0
                max: 3
                unit: kWh
                needle: true
                severity:
                  green: 0
                  yellow: 1.8
                  red: 2.4
              
              - type: gauge
                entity: sensor.seche_linge_daily_energy
                name: S√®che-Linge
                min: 0
                max: 5
                unit: kWh
                needle: true
                severity:
                  green: 0
                  yellow: 3
                  red: 4

          - type: horizontal-stack
            cards:
              - type: gauge
                entity: sensor.chauffe_eau_daily_energy
                name: Chauffe-Eau
                min: 0
                max: 10
                unit: kWh
                needle: true
                severity:
                  green: 0
                  yellow: 6
                  red: 8
              
              - type: gauge
                entity: sensor.four_daily_energy
                name: Four
                min: 0
                max: 3
                unit: kWh
                needle: true
                severity:
                  green: 0
                  yellow: 1.8
                  red: 2.4
              
              - type: gauge
                entity: sensor.bambulab_x1c_daily_energy
                name: Imprimante 3D
                min: 0
                max: 5
                unit: kWh
                needle: true
                severity:
                  green: 0
                  yellow: 3
                  red: 4

      # Scheduling Configuration
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### ‚è∞ Planification des Usages"
          
          - type: entities
            title: Activation Scheduling
            entities:
              - entity: switch.lave_linge_scheduling
                name: "üß∫ Lave-Linge"
              - entity: switch.lave_vaisselle_scheduling
                name: "üçΩÔ∏è Lave-Vaisselle"
              - entity: switch.seche_linge_scheduling
                name: "üëï S√®che-Linge"
              - entity: switch.chauffe_eau_scheduling
                name: "üíß Chauffe-Eau"
              - entity: switch.four_scheduling
                name: "üçï Four"

      # Auto-Shutdown Switches
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### üîå Arr√™t Automatique"
          
          - type: entities
            title: Auto-Shutdown
            entities:
              - entity: switch.lave_linge_auto_shutdown
                name: "üß∫ Lave-Linge"
              - entity: switch.lave_vaisselle_auto_shutdown
                name: "üçΩÔ∏è Lave-Vaisselle"
              - entity: switch.seche_linge_auto_shutdown
                name: "üëï S√®che-Linge"
              - entity: switch.chauffe_eau_auto_shutdown
                name: "üíß Chauffe-Eau"

      # Tendances Mensuelles
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### üìà Tendances Mensuelles"
          
          - type: custom:apexcharts-card
            header:
              show: true
              title: √âvolution Consommation Mensuelle
              show_states: true
            graph_span: 12month
            span:
              end: month
            all_series_config:
              type: area
              stroke_width: 2
              curve: smooth
              group_by:
                func: sum
                duration: 1month
            series:
              - entity: sensor.lave_linge_monthly_energy
                name: Lave-Linge
                color: '#3498db'
              - entity: sensor.lave_vaisselle_monthly_energy
                name: Lave-Vaisselle
                color: '#16a085'
              - entity: sensor.seche_linge_monthly_energy
                name: S√®che-Linge
                color: '#e67e22'
              - entity: sensor.chauffe_eau_monthly_energy
                name: Chauffe-Eau
                color: '#f39c12'

  # ============================================
  # VUE 8: CONTR√îLES GLOBAUX
  # ============================================
  - title: Contr√¥les Globaux
    path: controls
    icon: mdi:tune
    cards:
      - type: markdown
        content: |
          ## üéöÔ∏è Contr√¥les Globaux
          Gestion centralis√©e de tous les appareils

      # Switches Monitoring
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### üëÅÔ∏è Surveillance Automatique"
          
          - type: entities
            title: Monitoring
            entities:
              - entity: switch.lave_linge_monitoring
                name: "üß∫ Lave-Linge"
              - entity: switch.lave_vaisselle_monitoring
                name: "üçΩÔ∏è Lave-Vaisselle"
              - entity: switch.seche_linge_monitoring
                name: "üëï S√®che-Linge"
              - entity: switch.chauffe_eau_monitoring
                name: "üíß Chauffe-Eau"
              - entity: switch.four_monitoring
                name: "üçï Four"
              - entity: switch.bambulab_x1c_monitoring
                name: "üñ®Ô∏è Imprimante 3D"
              - entity: switch.ecran_pc_monitoring
                name: "üñ•Ô∏è √âcran PC"
              - entity: switch.bureau_pc_monitoring
                name: "üíª PC Bureau"
              - entity: switch.vmc_monitoring
                name: "üí® VMC"

      # Switches Notifications Master
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### üîî Notifications Principales"
          
          - type: entities
            title: Notifications Master
            entities:
              - entity: switch.lave_linge_notifications
                name: "üß∫ Lave-Linge"
              - entity: switch.lave_vaisselle_notifications
                name: "üçΩÔ∏è Lave-Vaisselle"
              - entity: switch.seche_linge_notifications
                name: "üëï S√®che-Linge"
              - entity: switch.chauffe_eau_notifications
                name: "üíß Chauffe-Eau"
              - entity: switch.four_notifications
                name: "üçï Four"
              - entity: switch.bambulab_x1c_notifications
                name: "üñ®Ô∏è Imprimante 3D"
              - entity: switch.ecran_pc_notifications
                name: "üñ•Ô∏è √âcran PC"
              - entity: switch.bureau_pc_notifications
                name: "üíª PC Bureau"
              - entity: switch.vmc_notifications
                name: "üí® VMC"

      # Notifications D√©taill√©es par Type
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### üì¢ Notifications D√©taill√©es"
          
          - type: entities
            title: Cycle D√©marr√©
            entities:
              - entity: switch.lave_linge_notification_cycle_started
                name: "üß∫ Lave-Linge"
              - entity: switch.lave_vaisselle_notification_cycle_started
                name: "üçΩÔ∏è Lave-Vaisselle"
              - entity: switch.seche_linge_notification_cycle_started
                name: "üëï S√®che-Linge"
          
          - type: entities
            title: Cycle Termin√©
            entities:
              - entity: switch.lave_linge_notification_cycle_finished
                name: "üß∫ Lave-Linge"
              - entity: switch.lave_vaisselle_notification_cycle_finished
                name: "üçΩÔ∏è Lave-Vaisselle"
              - entity: switch.seche_linge_notification_cycle_finished
                name: "üëï S√®che-Linge"
          
          - type: entities
            title: Alerte Dur√©e
            entities:
              - entity: switch.lave_linge_notification_alert_duration
                name: "üß∫ Lave-Linge"
              - entity: switch.lave_vaisselle_notification_alert_duration
                name: "üçΩÔ∏è Lave-Vaisselle"
              - entity: switch.seche_linge_notification_alert_duration
                name: "üëï S√®che-Linge"
          
          - type: entities
            title: Appareil D√©branch√©
            entities:
              - entity: switch.lave_linge_notification_unplugged
                name: "üß∫ Lave-Linge"
              - entity: switch.lave_vaisselle_notification_unplugged
                name: "üçΩÔ∏è Lave-Vaisselle"
              - entity: switch.seche_linge_notification_unplugged
                name: "üëï S√®che-Linge"

      # Boutons Reset Stats
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### üîÑ R√©initialisation des Statistiques"
          
          - type: entities
            title: Reset Statistiques
            entities:
              - entity: button.lave_linge_reset_stats
                name: "üß∫ Lave-Linge"
              - entity: button.lave_vaisselle_reset_stats
                name: "üçΩÔ∏è Lave-Vaisselle"
              - entity: button.seche_linge_reset_stats
                name: "üëï S√®che-Linge"
              - entity: button.chauffe_eau_reset_stats
                name: "üíß Chauffe-Eau"
              - entity: button.four_reset_stats
                name: "üçï Four"
              - entity: button.bambulab_x1c_reset_stats
                name: "üñ®Ô∏è Imprimante 3D"
              - entity: button.ecran_pc_reset_stats
                name: "üñ•Ô∏è √âcran PC"
              - entity: button.bureau_pc_reset_stats
                name: "üíª PC Bureau"
              - entity: button.vmc_reset_stats
                name: "üí® VMC"

  # ============================================
  # VUE 9: EXPORT & SERVICES
  # ============================================
  - title: Export & Services
    path: export
    icon: mdi:download
    cards:
      - type: markdown
        content: |
          ## üì§ Export & Services
          Export de donn√©es et services avanc√©s

      # Export CSV par Appareil
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### üìÑ Export CSV"
          
          - type: horizontal-stack
            cards:
              - type: button
                name: Lave-Linge
                icon: mdi:washing-machine
                tap_action:
                  action: call-service
                  service: smart_appliance_monitor.export_to_csv
                  service_data:
                    entity_id: sensor.lave_linge_state
              
              - type: button
                name: Lave-Vaisselle
                icon: mdi:dishwasher
                tap_action:
                  action: call-service
                  service: smart_appliance_monitor.export_to_csv
                  service_data:
                    entity_id: sensor.lave_vaisselle_state
              
              - type: button
                name: S√®che-Linge
                icon: mdi:tumble-dryer
                tap_action:
                  action: call-service
                  service: smart_appliance_monitor.export_to_csv
                  service_data:
                    entity_id: sensor.seche_linge_state

      # Export JSON par Appareil
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### üì¶ Export JSON"
          
          - type: horizontal-stack
            cards:
              - type: button
                name: Lave-Linge
                icon: mdi:washing-machine
                tap_action:
                  action: call-service
                  service: smart_appliance_monitor.export_to_json
                  service_data:
                    entity_id: sensor.lave_linge_state
              
              - type: button
                name: Lave-Vaisselle
                icon: mdi:dishwasher
                tap_action:
                  action: call-service
                  service: smart_appliance_monitor.export_to_json
                  service_data:
                    entity_id: sensor.lave_vaisselle_state
              
              - type: button
                name: S√®che-Linge
                icon: mdi:tumble-dryer
                tap_action:
                  action: call-service
                  service: smart_appliance_monitor.export_to_json
                  service_data:
                    entity_id: sensor.seche_linge_state

      # Services Avanc√©s
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### üõ†Ô∏è Services Avanc√©s"
          
          - type: button
            name: Synchroniser Energy Dashboard
            icon: mdi:sync
            tap_action:
              action: call-service
              service: smart_appliance_monitor.sync_with_energy_dashboard
          
          - type: button
            name: D√©tecter Syst√®me Tarifaire
            icon: mdi:cash-check
            tap_action:
              action: call-service
              service: smart_appliance_monitor.detect_tariff_system
          
          - type: entities
            title: Donn√©es √ânergie
            entities:
              - type: button
                name: Obtenir Donn√©es Jour
                icon: mdi:calendar-today
                tap_action:
                  action: call-service
                  service: smart_appliance_monitor.get_energy_data
                  service_data:
                    period: today
              
              - type: button
                name: Obtenir Donn√©es Mois
                icon: mdi:calendar-month
                tap_action:
                  action: call-service
                  service: smart_appliance_monitor.get_energy_data
                  service_data:
                    period: month

      # Historique Cycles
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### üìú Historique des Cycles"
          
          - type: markdown
            content: >
              Utilisez les services `get_cycle_history` pour consulter l'historique d√©taill√© de chaque appareil.
              
              
              Exemple : 
              
              ```yaml
              
              service: smart_appliance_monitor.get_cycle_history
              
              data:
                entity_id: sensor.lave_linge_state
                days: 7
              ```

      # Analyse Energy Dashboard Globale
      - type: vertical-stack
        cards:
          - type: markdown
            content: "### üîç Analyse Energy Dashboard"
          
          - type: button
            name: Analyse Globale (7j)
            icon: mdi:chart-timeline-variant
            tap_action:
              action: call-service
              service: smart_appliance_monitor.analyze_energy_dashboard
              service_data:
                days: 7
          
          - type: button
            name: Analyse Globale (30j)
            icon: mdi:chart-line
            tap_action:
              action: call-service
              service: smart_appliance_monitor.analyze_energy_dashboard
              service_data:
                days: 30

